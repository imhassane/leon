#define CONFIGURE_INIT
#include "system.h"
#include "returncode.h"
#include "random.h"
#include <signal.h>
#include <stdio.h>
#include <sched.h>
#include <stdlib.h>
#include <semaphore.h>
#include <errno.h>



//----------------- Fonctions suppl√©mentaires ----------------

int keys[5][5][5][5] =


{


  // [0]


  {


    // [0][0]


    {


      {0,0,0,0,0},


      {0,0,0,0,0},


      {0,0,0,0,0},


      {0,0,0,0,0},


      {0,0,0,0,0}


    },


    // [0][1]


    {


      {0,0,0,0,0},


      {0,0,0,0,0},


      {0,0,0,0,0},


      {0,0,0,0,0},


      {0,0,0,0,0}


    },


    // [0][2]


    {


      {0,0,0,0,0},


      {0,0,0,0,0},


      {0,0,0,0,0},


      {0,0,0,0,0},


      {0,0,0,0,0}


    },


    // [0][3]


    {


      {0,0,0,0,0},


      {0,0,0,0,0},


      {0,0,0,0,0},


      {0,0,0,0,0},


      {0,0,0,0,0}


    },


    // [0][4]


    {


      {0,0,0,0,0},


      {0,0,0,0,0},


      {0,0,0,0,0},


      {0,0,0,0,0},


      {0,0,0,0,0}


    }


  },


  // [1]


  {


    // [1][0]


    {


      {1,1,1,1,1},


      {1,1,1,1,1},


      {1,1,1,1,1},


      {1,1,1,1,1},


      {1,1,1,1,1}


    },


    // [1][1]


    {


      {1,1,1,1,1},


      {1,1,1,1,1},


      {1,1,1,1,1},


      {1,1,1,1,1},


      {1,1,1,1,1}


    },


    // [1][2]


    {


      {1,1,1,1,1},


      {1,1,1,1,1},


      {1,1,1,1,1},


      {1,1,1,1,1},


      {1,1,1,1,1}


    },


    // [1][3]


    {


      {1,1,1,1,1},


      {1,1,1,1,1},


      {1,1,1,1,1},


      {1,1,1,1,1},


      {1,1,1,1,1}


    },


    // [1][4]


    {


      {1,1,1,1,1},


      {1,1,1,1,1},


      {1,1,1,1,1},


      {1,1,1,1,1},


      {1,1,1,1,1}


    }


  },


  // [2]


  {


    // [2][0]


    {


      {2,2,2,2,2},


      {2,2,2,2,2},


      {2,2,2,2,2},


      {2,2,2,2,2},


      {2,2,2,2,2}


    },


    // [2][1]


    {


      {2,2,2,2,2},


      {2,2,2,2,2},


      {2,2,2,2,2},


      {2,2,2,2,2},


      {2,2,2,2,2}


    },


    // [2][2]


    {


      {2,2,2,2,2},


      {2,2,2,2,2},


      {2,2,2,2,2},


      {2,2,2,2,2},


      {2,2,2,2,2}


    },


    // [2][3]


    {


      {2,2,2,2,2},


      {2,2,2,2,2},


      {2,2,2,2,2},


      {2,2,2,2,2},


      {2,2,2,2,2}


    },


    // [2][4]


    {


      {2,2,2,2,2},


      {2,2,2,2,2},


      {2,2,2,2,2},


      {2,2,2,2,2},


      {2,2,2,2,2}


    }


  },


  // [3]


  {


    // [3][0]


    {


      {3,3,3,3,3},


      {3,3,3,3,3},


      {3,3,3,3,3},


      {3,3,3,3,3},


      {3,3,3,3,3}


    },


    // [3][1]


    {


      {3,3,3,3,3},


      {3,3,3,3,3},


      {3,3,3,3,3},


      {3,3,3,3,3},


      {3,3,3,3,3}


    },


    // [3][2]


    {


      {3,3,3,3,3},


      {3,3,3,3,3},


      {3,3,3,3,3},


      {3,3,3,3,3},


      {3,3,3,3,3}


    },


    // [3][3]


    {


      {3,3,3,3,3},


      {3,3,3,3,3},


      {3,3,3,3,3},


      {3,3,3,3,3},


      {3,3,3,3,3}


    },


    // [3][4]


    {


      {3,3,3,3,3},


      {3,3,3,3,3},


      {3,3,3,3,3},


      {3,3,3,3,3},


      {3,3,3,3,3}


    }


  },


  // [4]


  {


    // [4][0]


    {


      {4,4,4,4,4},


      {4,4,4,4,4},


      {4,4,4,4,4},


      {4,4,4,4,4},


      {4,4,4,4,4}


    },


    // [4][1]


    {


      {4,4,4,4,4},


      {4,4,4,4,4},


      {4,4,4,4,4},


      {4,4,4,4,4},


      {4,4,4,4,4}


    },


    // [4][2]


    {


      {4,4,4,4,4},


      {4,4,4,4,4},


      {4,4,4,4,4},


      {4,4,4,4,4},


      {4,4,4,4,4}


    },


    // [4][3]


    {


      {4,4,4,4,4},


      {4,4,4,4,4},


      {4,4,4,4,4},


      {4,4,4,4,4},


      {4,4,4,4,4}


    },


    // [4][4]


    {


      {4,4,4,4,4},


      {4,4,4,4,4},


      {4,4,4,4,4},


      {4,4,4,4,4},


      {4,4,4,4,


#ifdef FIND_TARGET


       400


#else


       401                      /* not searched for */


#endif


      }


    }


  }


};



int answer[5][5][5][5] =


{


  // [0]


  {


    // [0][0]


    {


      {123,123,123,123,123},


      {123,123,123,123,123},


      {123,123,123,123,123},


      {123,123,123,123,123},


      {123,123,123,123,123}


    },


    // [0][1]


    {


      {123,123,123,123,123},


      {123,123,123,123,123},


      {123,123,123,123,123},


      {123,123,123,123,123},


      {123,123,123,123,123}


    },


    // [0][2]


    {


      {123,123,123,123,123},


      {123,123,123,123,123},


      {123,123,123,123,123},


      {123,123,123,123,123},


      {123,123,123,123,123}


    },


    // [0][3]


    {


      {123,123,123,123,123},


      {123,123,123,123,123},


      {123,123,123,123,123},


      {123,123,123,123,123},


      {123,123,123,123,123}


    },


    // [0][4]


    {


      {123,123,123,123,123},


      {123,123,123,123,123},


      {123,123,123,123,123},


      {123,123,123,123,123},


      {123,123,123,123,123}


    }


  },


  // [1]


  {


    // [1][0]


    {


      {234,234,234,234,234},


      {234,234,234,234,234},


      {234,234,234,234,234},


      {234,234,234,234,234},


      {234,234,234,234,234}


    },


    // [1][1]


    {


      {234,234,234,234,234},


      {234,234,234,234,234},


      {234,234,234,234,234},


      {234,234,234,234,234},


      {234,234,234,234,234}


    },


    // [1][2]


    {


      {234,234,234,234,234},


      {234,234,234,234,234},


      {234,234,234,234,234},


      {234,234,234,234,234},


      {234,234,234,234,234}


    },


    // [1][3]


    {


      {234,234,234,234,234},


      {234,234,234,234,234},


      {234,234,234,234,234},


      {234,234,234,234,234},


      {234,234,234,234,234}


    },


    // [1][4]


    {


      {234,234,234,234,234},


      {234,234,234,234,234},


      {234,234,234,234,234},


      {234,234,234,234,234},


      {234,234,234,234,234}


    }


  },


  // [2]


  {


    // [2][0]


    {


      {345,345,345,345},


      {345,345,345,345},


      {345,345,345,345},


      {345,345,345,345},


      {345,345,345,345}


    },


    // [2][1]


    {


      {345,345,345,345},


      {345,345,345,345},


      {345,345,345,345},


      {345,345,345,345},


      {345,345,345,345}


    },


    // [2][2]


    {


      {345,345,345,345},


      {345,345,345,345},


      {345,345,345,345},


      {345,345,345,345},


      {345,345,345,345}


    },


    // [2][3]


    {


      {345,345,345,345},


      {345,345,345,345},


      {345,345,345,345},


      {345,345,345,345},


      {345,345,345,345}


    },


    // [2][4]


    {


      {345,345,345,345},


      {345,345,345,345},


      {345,345,345,345},


      {345,345,345,345},


      {345,345,345,345}


    }


  },


  // [3]


  {


    // [3][0]


    {


      {456,456,456,456,456},


      {456,456,456,456,456},


      {456,456,456,456,456},


      {456,456,456,456,456},


      {456,456,456,456,456}


    },


    // [3][1]


    {


      {456,456,456,456,456},


      {456,456,456,456,456},


      {456,456,456,456,456},


      {456,456,456,456,456},


      {456,456,456,456,456}


    },


    // [3][2]


    {


      {456,456,456,456,456},


      {456,456,456,456,456},


      {456,456,456,456,456},


      {456,456,456,456,456},


      {456,456,456,456,456}


    },


    // [3][3]


    {


      {456,456,456,456,456},


      {456,456,456,456,456},


      {456,456,456,456,456},


      {456,456,456,456,456},


      {456,456,456,456,456}


    },


    // [3][4]


    {


      {456,456,456,456,456},


      {456,456,456,456,456},


      {456,456,456,456,456},


      {456,456,456,456,456},


      {456,456,456,456,456}


    }


  },


  // [4]


  {


    // [4][0]


    {


      {567,567,567,567,567},


      {567,567,567,567,567},


      {567,567,567,567,567},


      {567,567,567,567,567},


      {567,567,567,567,567}


    },


    // [4][1]


    {


      {567,567,567,567,567},


      {567,567,567,567,567},


      {567,567,567,567,567},


      {567,567,567,567,567},


      {567,567,567,567,567}


    },


    // [4][2]


    {


      {567,567,567,567,567},


      {567,567,567,567,567},


      {567,567,567,567,567},


      {567,567,567,567,567},


      {567,567,567,567,567}


    },


    // [4][3]


    {


      {567,567,567,567,567},


      {567,567,567,567,567},


      {567,567,567,567,567},


      {567,567,567,567,567},


      {567,567,567,567,567}


    },


    // [4][4]


    {


      {567,567,567,567,567},


      {567,567,567,567,567},


      {567,567,567,567,567},


      {567,567,567,567,567},


      {567,567,567,567,1111}


    }


  }


};

int foo(int x)

{


#ifdef TEST


  int c = 0;                    /* counter for innerloop */


#endif


  int i,j,k,l;





  for(i=0; i<5; i++)


    for(j=0 ; j<5 ; j++)


      for(k=0 ; k<5 ; k++)


        for(l=0 ; l<5 ; l++)


        {


#ifdef TEST


          c++;


#endif


          if( keys[i][j][k][l] == x )


            {


#ifdef TEST


              printf("   %d\n",c);


#endif


              return answer[i][j][k][l] + keys[i][j][k][l];


            }


        }


  return -1;


}


//-----------------------------------------------------------


struct timespec ts_period(struct timespec start, struct timespec end);

void* POSIX_Init(void *argument)
{
    
    int status, i;
    struct timespec start, end, time;

    status=clock_gettime(CLOCK_REALTIME, &start);
    if(status<0)
        returncode("gettime start",status);
    

    //---------------------- Espace de test ---------------------
    
    for(i = 0; i<1000; i++)
        foo(400);

    //-----------------------------------------------------------

    
    status=clock_gettime(CLOCK_REALTIME, &end);
    if(status<0)
        returncode("gettime end",status);
    
    time = ts_period(start, end);
    
    printf("\nTemps d'execution: %jd.%09ld \n", (intmax_t)time.tv_sec, time.tv_nsec);
    exit(0);
    return 0;
}

struct timespec ts_period(struct timespec start, struct timespec end)
{
    struct timespec res;
    
    res.tv_sec = end.tv_sec - start.tv_sec;
    res.tv_nsec = end.tv_nsec - start.tv_nsec;

    return(res);
}
